# projects/urls.py

from django.urls import path, include
from rest_framework.routers import DefaultRouter
from .views import (
    ProjectViewSet,
    ProjectsByCountryView,
    ProjectsByStatusView,
    # Import the new dashboard views
    ProjectCountByCountryView,
    ProjectCountByLeadOrgUnitView,
    ProjectCountByThemeView,
    WorldMapProjectDataView,
    # CountryListView, # Keep commented if not needed
    # ThemeListView, # Keep commented if not needed
)

# Create a router and register our viewsets with it.
router = DefaultRouter()
router.register(r'projects', ProjectViewSet, basename='project')

# The API URLs are now determined automatically by the router.
# urlpatterns = router.urls # This would include ONLY the router URLs

# Add custom URL patterns for views not covered by the router
urlpatterns = [
    # Include the URLs generated by the router (for ProjectViewSet)
    path('', include(router.urls)),

    # Custom URL for filtering projects by country name
    # <str:country_name> captures the country name from the URL as a string
    path('projects/country/<str:country_name>/', ProjectsByCountryView.as_view(), name='projects-by-country'),

    # Custom URL for filtering projects by status key
    # <str:status_key> captures the status key from the URL as a string
    path('projects/status/<str:status_key>/', ProjectsByStatusView.as_view(), name='projects-by-status'),

    # --- New URLs for Dashboard Aggregated Data ---
    # Endpoint for project count by country
    path('projects/summary/by_country/', ProjectCountByCountryView.as_view(), name='project-count-by-country'),

    # Endpoint for project count by lead organization unit
    path('projects/summary/by_org_unit/', ProjectCountByLeadOrgUnitView.as_view(), name='project-count-by-org-unit'),

    # Endpoint for project count by theme
    path('projects/summary/by_theme/', ProjectCountByThemeView.as_view(), name='project-count-by-theme'),

    # Endpoint for world map data (project count by country)
    path('projects/summary/world_map_data/', WorldMapProjectDataView.as_view(), name='world-map-project-data'),


    # Optional: URLs for listing other models if you uncommented those views
    # path('countries/', CountryListView.as_view(), name='country-list'),
    # path('themes/', ThemeListView.as_view(), name='theme-list'),
    # ... add paths for LeadOrgUnit and Donor lists if needed

]
